<app-header></app-header>

<div class="dashboard-container">
  <div class="bunnies-grid">
    @for (bunny of bunnies$ | async; track bunny.id) {
      <mat-card
        class="bunny-card"
        [style.border-color]="getBunnyBorderColor(bunny.colorClass)"
        (click)="viewBunny(bunny.id!)"
        [attr.aria-label]="'View ' + bunny.name + ' details'">
        <button
          mat-icon-button
          class="delete-button"
          (click)="deleteBunny($event, bunny)"
          [attr.aria-label]="'Delete ' + bunny.name"
          title="Delete bunny">
          <mat-icon>close</mat-icon>
        </button>
        <mat-card-content class="bunny-card-content">
          <div class="bunny-icon-wrapper">
            <img
              [src]="getBunnyIcon(bunny)"
              [alt]="bunny.name + ' icon'"
              class="bunny-icon" />
          </div>
          <h3 class="bunny-name">{{ bunny.name }}</h3>
          @if (isNewlyCreated(bunny)) {
            <div class="countdown-badge">
              {{ getCountdown(bunny) }}
            </div>
          }
        <div class="bunny-stats">
          <p class="happiness-label">Happiness: {{ bunny.happiness }}</p>
          <mat-progress-bar
            mode="determinate"
            [value]="bunny.progressBarPercent ?? 0"
            [color]="getProgressColor(bunny.mood)"
            [attr.aria-label]="'Happiness: ' + (bunny.progressBarPercent ?? 0) + '%'">
          </mat-progress-bar>
        </div>
      </mat-card-content>
      </mat-card>
    }

    @if (bunnies$ | async; as bunnies) {
      @if (canCreateBunny(bunnies.length)) {
        <mat-card class="add-bunny-card" (click)="openAddBunnyDialog()" aria-label="Add new bunny">
          <mat-card-content class="add-content">
            <mat-icon class="add-icon">add</mat-icon>
            <p>Add Bunny</p>
          </mat-card-content>
        </mat-card>
      } @else {
        <mat-card class="add-bunny-card limit-reached" aria-label="Maximum bunnies reached">
          <mat-card-content class="add-content">
            <mat-icon class="add-icon">sentiment_satisfied</mat-icon>
            <p>Ohh your family got big! ðŸ˜Š</p>
            <p class="limit-message">Time to kick out somebody! You have reached the maximum of {{ maxBunniesPerUser }} bunnies.</p>
          </mat-card-content>
        </mat-card>
      }
    }
  </div>
</div>

